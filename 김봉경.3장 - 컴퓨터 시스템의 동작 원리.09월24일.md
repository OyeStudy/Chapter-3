- `인터럽트` 
주변장치 및 입출력 장치는 CPU나 메모리와 달리 `인터럽트`라는 메커니즘을 통해 관리가 이루어진다.
주변장치들이 CPU의 서비스가 필요한 경우에 발생시키는 신호.

### 1. 컴퓨터 시스템의 구조

- 입력(input) : 컴퓨터 내부로 데이터가 들어오는 것
- 출력(output) : 컴퓨터 외부장치로 데이터가 나가는 것

- 메모리 및 입출력장치 등의 각 하드웨어 장치에는 `컨트롤러`라는 것이 붙어 있다.
`컨트롤러` : 각 하드웨어 장치마다 존재하면서 이들을 제어하는 작은 CPU

- `커널(kernel)` : 운영체제 중 항상 메모리에 올라가 있는 핵심적인 부분

<br/>

### 2. CPU 연산과 I/O 연산

- 입출력 장치와 메인 CPU는 동시 수행이 가능하다.

- `로컬버퍼(local buffer)`
장치 컨트롤러가 장치로부터 들어오고 나가는 데이터를 임시로 저장하기 위해 가지고 있는 작은 메모리

- 로컬버퍼로 읽어오는 작업이 끝났는지를 메인 CPU가 지속적으로 체크하는 것이 아니라 장치에 있는 컨트롤러가 `인터럽트`를 발생시켜 CPU에 보고한다.
`인터럽트` : 컨트롤러들이 CPU의 서비스가 필요할 때 발생시키는 신호

-  CPU는 인터럽트 라인에 신호가 들어오면 하던 일을 멈추고 인터럽트와 관련된 일을 먼저 처리한다.

<br/>

### 3. 인터럽트의 일반적 기능

- 운영체제 커널에는 인터럽트가 들어왔을 때 해야 할 일이 미리 다 프로그래밍되어 그 코드가 보관돼 있다.

- `인터럽트 처리루틴` : 운영체제 커널 내에는 다양한 인터럽트에 대해 각각 처리해야 할 업무들을 정의하고 있다.

- 인터럽트에는 `하드웨어 인터럽트` ・ `소프트웨어 인터럽트`가 있고, 인터럽트가 발생했음을 알려주는 방식은 둘 다 동일하다.

- `인터럽트 벡터(interrupt vector)`
인터럽트 종류마다 번호를 정해서, 번호에 따라 처리해야 할 코드가 위치한 부분을 가리키고 있는 자료구조를 말한다.

- 실제 처리해야 할 코드는 `인터럽트 처리루틴(interrupt service routine)`또는 `인터럽트 핸들러(interrupt handler)`라고 불리는 다른 곳에 정의된다.

- 인터럽트 처리루틴을 통해 해당하는 인터럽트 처리를 완료하고 나면 원래 수행하던 작업으로 돌아가 중단되었던 일을 계속해서 수행해야 하는데 이러한 정보를 저장하기 위한 장소를 운영체제는 별도로 가지고 있다.

- 통상적으로 인터럽트라고 하면 `하드웨어 인터럽트`를 의미하고, `소프트웨어 인터럽트`는 `트랩(trap)`이라는 용어로 주로 불린다.

- `소프트웨어 인터럽트`에 해당하는 `시스템 콜(system call)`이나 `예외상황(exception)`은 모두 사용자 프로세스로부터 CPU의 제어권이 운영체제에 이양되어 처리 된다.

<br/>

### 4. 인터럽트 핸들링

- `인터럽트 핸들링(interrupt handling)`
인터럽트가 발생한 경우에 처리해야 할 일의 절차를 의미한다.

- CPU에서 명령이 실행될 때에는 CPU 내부에 있는 임시 기억장치인 레지스터(register)에 데이터를 읽거나 쓰면서 작업을 하는데, 이때 인터럽트가 발생해 새로운 명령을 실행하면 기존의 레지스터값들이 지워지게 되므로 CPU 내의 이러한 상태를 저장해두어야 한다.

- `프로세스 제어블록(Process Control Block: PCB)`
운영체제가 현재 시스템 내에서 실행되는 프로그램들을 관리하기 위한 자료구조이다.

- `PCB`
각각의 프로그램마다 하나씩 존재하며 해당 프로그램의 어느 부분이 실행 중이었는지를 저장한다.

```
A프로그램 실행 중 -> 인터럽트 발생 -> A프로그램 상태 PCB에 저장 -> CPU 제어권 인터럽트 처리루틴으로 넘어감 -> 인터럽트 처리 끝 -> A프로그램 저장 관련 정보 PCB로부터 CPU상에 복원 -> A프로그램 다시 실행
```

- 운영체제가 직접 CPU를 점유하는 경우는 인터럽트에 의하지 않고는 발생하지 않는다.

<br/>

### 5. 입출력 구조

- `입출력(I/O)`이란 컴퓨터 시스템이 컴퓨터 외부의 입출력 장치들과 데이터를 주고받는 것을 말한다.

- 입출력 방식에는 `동기식 입출력`과 `비동기식 입출력`이 있다.

- `동기식 입출력(synchronous I/O)`
  - 어떤 프로그램이 입출력 요청을 했을 때 입출력 작업이 완료된 후에야 그 프로그램이 후속 작업을 수행할 수 있는 방식
  - CPU를 다른 프로그램에게 양도한다.
  - 입출력 중인 프로그램의 경우 `봉쇄 상태(blocked state)`로 전환시킨다.
  - 입출력 요청의 동기화를 위해 장치별로 `큐(queue)`를 두어 요청한 순서대로 처리할 수 있도록 한다.
  
- `비동기식 입출력`
  - CPU의 제어권을 입출력 연산을 호출한 그 프로그램에게 곧바로 다시 부여하는 방식이다.
  - 입출력 연산이 완료되는 것과 무관하게 처리 가능한 작업부터 처리한다.
  
- 입출력 연산이 완료되면 인터럽트를 통해 이를 CPU에 알려주는 것은 `동기식 입출력`과 `비동기식 입출력` 둘 다 같은 방식이다.

- 일반적으로 `동기식 입출력`을 사용한다.

---
