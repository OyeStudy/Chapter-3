# 컴퓨터 시스템의 동작 원리
## 1. 컴퓨터 시스템의 구조
입력(input) : 컴퓨터 내부로 데이터가 들어오는 것
출력(output) : 컴퓨터 외부장치로 데이터가 나가는 것
컨트롤러 : 각 하드웨어 장치마다 존재하는 일종의 작은 CPU

***

## 2. CPU 연산과 I/O 연산
컴퓨터 내에서 수행되는 연산은 메인 CPU가 담당, I/O 연산은 컨트롤러가 담당하고 있으며 동시 수행 가능
### 로컬 버퍼
장치로부터 들어오고 나가는 데이터를 임시로 저장하기 위한 작은 메모리
컨트롤러가 담당

이때 로컬버퍼로 읽어오는 작업 종료 여부는 메인 CPU가 체크하는 것이 아닌 컨트롤러가 인터럽트를 발생시켜 CPU에 보고하게 됨.

CPU는 매 시점 메모리에서 명령(instruction)을 하나씩 읽어 수행 → 인터럽트 라인(interrupt line)에 신호가 들어오면 하던 일을 멈추고 인터럽트 수행 좀 더 정확히는 CPU는 명령 하나를 수행할 때 마다 인터럽트 발생 여부를 확인함.

***
## 3. 인터럽트의 일반적 기능
운영체제가 해야 할 일들을 운영체제의 개발자가 미리 프로그래밍해서 커널 내에 포함시켜두는 것

|구분|하드웨어 인터럽트|소프트웨어 인터럽트|
|:--------:|:--------:|:--------:|
|처리방식|하드웨어 컨트롤러 등 하드웨어 장치가 CPU의 인터럽트 라인을 세팅| 소프트웨어가 그 일을 직접 수행|
인터럽트 라인에 신호를 보내 인터럽트가 발생했음을 알려주는 방식은 동일

_인터럽트 벡터란?
인터럽트 종류마다 번호를 정해, 번호에 따라 처리해야 할 코드가 위치한 부분을 가리키고 있는 자료구조
실제 처리해야 할 코드는 인터럽트 처리루틴(interrupt service routine) 또는 인터럽트 핸들러(interrupt handler)라고 불리는 곳에 정의됨._

	cf)보통 인터럽트 핸들러를 사용하는 것 같음

### 소프트웨어 인터럽트(trap)
#### 예외상황(exeception)
권한이 없는 작업을 시도할 때 이에 대한 처리를 위해 발생시키는 인터럽트

	ex) 비정상적인 작업을 시도하거나 자신의 메모리 영역 바깥에 접근하는 등
#### 시스템 콜(system call)
사용자 프로그램이 운영체제 내부에 정의된 코 드를 실행하고 싶을 때 운영체제에 서비스를 요청하는 방법

	ex) App. 개발자가 프로그램 작성 중 I/O 작업이 필요할 경우 본인이 직접 코드를 작성하는 것이 아니라 이미 존재하는 커널의 코드를 호출해서 처리
***
## 4. 인터럽트 핸들링
_인터럽트 핸들링(interrupt handling)이란?
인터럽트가 발생한 경우 처리해야 할 일의 절차_

CPU에서 명령이 실행될 때에는 CPU 내부에 있는 임시 기억장치인 레지스터(register)에 데이터를 읽거나 쓸 때 인터럽트가 발생해 데이터를 지워지지 않도록 CPU 내의 이러한 상태를 모두 저장해야 인터럽트 처리가 이뤄질 수 있다.

- 제어블록(Process Control Block:PCB)
현재 시슽메 내에서 실행되는 프로그램들을 고나리하기 위한 자료구조

PCB는 각각의 프로그램마다 하나씩 존재하며 해당 프로그램의 어느 부분이 실행 중이었는지를 저장한다. (코드의 메모리 주소,레지스터 값, 하드웨어 상태 등)
오늘날의 컴퓨터 운영체제는 인터럽트가 발생할 때에만 운영체제 코드 부분으로 CPU가 이양되어 인터럽트 처리를 수행결론적으로 운영체제가 직접 CPU를 점유하는 경우는 인터럽트에 의하지 않고는 발생하지 않으나 컴퓨터 시스템 내의 모든 H/W 및 S/W 자원을 체계적이고 효율적으로 관리할 수 있다.
***
## 5. 입출력 구조
_입출력(I/O)이란?
컴퓨터 시스템이 컴퓨터 외부의 입출력 장치들과 데이터를 주고 받는 것._

### 동기식 입출력 (synchronous I/O)
입출력 작업이 완료된 후 해당 프로그램이 후속 작업을 수행할 수 있는 방식

장점 
- 요청의 갯수가 적고 요청의 크기가 큰 경우 CPU의 명령 수행 속도가 빠름

단점
- CPU I/O 연산이 끝날 때 까지 인터럽트를 기다리며 자원 낭비
- I/O 연산은 상대적으로 느림 

### 비동기식 입출력 (asynchronous I/O)
CPU가 I/O 요청 후 I/O 장치에서 일어나는 작업을 고려하지 않고 CPU가 다음 작업을 실행하는 방식

장점
- 동기식 입출력에 비해서 메모리 점유율이 낮음
- I/O 작업이 이루어지는 동안 메모리를 점유하지 않음
- 이렇게 처리 할 경우 I/O 요청으로 인해 끊김 없이 계속해서 요청을 받을 수 있음

단점
- 요청을 처리하는데 시간이 오래 걸린다면 적합하지 않음
- 작업의 크기가 커서 CPU를 많이 차지하는 경우 다수의 요청을 처리하기에 적합하지 않음

운영체제는 장치별로 I/O를 기다리는 프로세스를 줄 세워 관리함으로써 동기성을 보장하게 된다.